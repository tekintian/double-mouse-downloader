appId: 'moe.moyu.double-mouse-downloader'
productName: 鼠鼠下载器
publish:
  provider: github
  owner: tekintian
  repo: double-mouse-downloader
  releaseType: release

# 添加压缩配置
compression: maximum
# 移除不必要的文件
files:
  - from: build
    to: build
    filter: ["**/*", "!**/*.map"]
  - from: node_modules
    to: node_modules
    filter: [
      "!**/*.md",
      "!**/test/**",
      "!**/tests/**",
      "!**/docs/**",
      "!**/.github/**",
      "!**/examples/**",
      "!**/benchmark/**"
    ]
  - package.json

# 添加 asar 打包
asar: true
asarUnpack:
  - "./bin/${platform}/${arch}/*"  # 二进制文件不打包到 asar 中

# 为所有平台配置构建产物的文件名格式
artifactName: "${name}-${version}-${arch}.${ext}"

# 为mac平台单独配置，确保覆盖默认设置
mac:
  target:
    - target: dmg
      arch:
        - x64
        - arm64
    - target: zip
      arch:
        - x64
        - arm64
  minimumSystemVersion: '10.13'
  hardenedRuntime: true
  entitlements: entitlements.plist
  entitlementsInherit: entitlements.plist
  # 确保mac平台也使用相同的文件名格式
  artifactName: "${name}-${version}-${arch}.${ext}"

win:
  target:
    - target: nsis
      arch:
        - x64
    - target: 7z
      arch:
        - x64
  # 确保windows平台也使用相同的文件名格式
  artifactName: "${name}-${version}-${arch}.${ext}"

directories:
  buildResources: ./build-resources

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  installerLanguages: 'zh_CN'
  language: '2052'

extraResources:
  - ./bin/${platform}/${arch}/*